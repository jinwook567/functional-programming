# 1.31

```js
function product(term, a, next, b) {
  return a > b ? 1 : term(a) * product(term, next(a), next, b);
}

function product2(term, a, next, b) {
  function iter(a, result) {
    if (a > b) return result;
    return iter(next(a), term(a) * result);
  }

  return iter(a, 1);
}

function factorial(n) {
  return product((a) => a, 1, inc, n);

  function inc(a) {
    return a + 1;
  }
}

function pi(n) {
  return product(
    (x) => ((x - 1) * (x + 1)) / (x * x),
    3,
    (x) => x + 2,
    n
  );
}
```

# 1.32

```js
function accmulate(combiner, null_value, term, a, next, b) {
  if (a > b) return null_value;
  return accmulate(
    combiner,
    combiner(null_value, term(a)),
    term,
    next(a),
    next,
    b
  );
}

function accmulate2(combiner, null_value, term, a, next, b) {
  function iter(a, result) {
    if (a > b) return result;
    return iter(next(a), combiner(result, term(a)));
  }

  return iter(a, null_value);
}

function sum(term, a, next, b) {
  return accmulate((a, b) => a + b, 0, term, a, next, b);
}

function product(term, a, next, b) {
  return accmulate((a, b) => a * b, 1, term, a, next, b);
}
```

# 1.33

```js
function accmulate(combiner, null_value, term, a, next, b, filter) {
  if (a > b) return null_value;
  return accmulate(
    combiner,
    filter(term(a)) ? combiner(null_value, term(a)) : null_value,
    term,
    next(a),
    next,
    b,
    filter
  );
}

function isPrime(n) {
  for (let i = 2; i <= Math.floor(Math.sqrt(n)); i++) {
    if (n % i === 0) return false;
  }
  return true;
}

function add(a, b) {
  return a + b;
}

function identity(a) {
  return a;
}

function inc(a) {
  return a + 1;
}

function gcd(a, b) {
  if (b === 0) return a;
  return gcd(b, a % b);
}

function sumPrime(start, end) {
  return accmulate(add, 0, identity, start, inc, end, isPrime);
}

function disjoint_list(n) {
  return accmulate(add, 0, identity, 1, inc, n - 1, (a) => gcd(a, n) === 1);
}
```
